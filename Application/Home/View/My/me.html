<!--<script src="__ROOT__/Public/login/assets/js/jquery-1.11.1.min.js">
</script>-->
<link rel="stylesheet" type="text/css" href="__ROOT__/Public/FirstEdition/assets/shu/boot/table.css" />
<!--<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />-->
<script>
	$('#11').parents('li').addClass('nav-active')
	$('#11').parents('li').addClass('nav-expanded')
</script>
<style>
	.six:before {
		content: "";
		position: absolute;
		top: -25px;
		left: 0;
		width: 0;
		height: 0;
		border-left: 50px solid transparent;
		border-right: 50px solid transparent;
		border-bottom: 25px solid #ececec;
	}
	
	.six:after {
		content: "";
		position: absolute;
		bottom: -25px;
		left: 0;
		width: 0;
		height: 0;
		border-left: 50px solid transparent;
		border-right: 50px solid transparent;
		border-top: 25px solid #ececec;
	}
	
	.dropdown-toggle {
		height: 34px;
	}
	
	label {
		margin-bottom: 0;
	}
</style>
<div id="node_message" style="position: fixed;top: 50%;left: 50%;display: none;background: #888;min-width:300px;margin-left: -150px;margin-top:-15px;border-radius: 8px;text-align: center;font-size: 16px;padding: 12px 20px;color: #fff;z-index: 1200;"></div>
<div class="row">
	<div class="col-md-12">
		<section class="panel">
			<header class="panel-heading">
				<div class="panel-actions">
					<a href="#" class="panel-action panel-action-toggle" data-panel-toggle=""></a>
					<a href="#" class="panel-action panel-action-dismiss" data-panel-dismiss=""></a>
				</div>
				<input type="hidden" name='getRoleAuthority' value="{:U('System/getRoleAuthority','','')}">
				<h2 class="panel-title">{$Think.lang.personal_information}</h2>
			</header>
			<!--<div class="panel-body">
                <button class="btn btn-primary" onclick=""> </button>
            </div>-->
			<input type="hidden" name='getRoleAuthority' value="{:U('System/getRoleAuthority','','')}">
			<input type="hidden" name='delRole' value="{:U('System/delRole','','')}">
			<div class="panel-body">
				<div style="width: 37%;float: left;">
					<div style="width: 100%;height: 180px;">
						<div style="margin: 0 auto;">
							<foreach name="info" item="vo">
								<img style="width: 160px;display: block;height: 160px;margin: 0 auto;cursor: pointer;box-sizing: content-box;border: 1px solid #ddd;" src="__ROOT__{$vo.path}" onclick="location.href='__ROOT__/index.php/Home/my/avatar'" />
							</foreach>
						</div>

					</div>
					<foreach name="info" item="vo">
						<div style="height: 70px;background: deepskyblue;color: #fff;text-align: center;line-height: 24px;">
							<div style="width: 33%;border-right: 1px solid #fff;height: 100%;float: left;">
								<p style="padding-top: 12px;margin-bottom: 0;">白金</p>
								<p>雇员</p>
							</div>
							<div style="width: 34%;border-right: 1px solid #fff;height: 100%;float: left;;">
								<p style="padding-top: 12px;margin-bottom: 0;">Active</p>
								<eq name="vo.status" value="1">
									正常
									<else/> 离职
								</eq>
							</div>
							<div style="width: 33%;height: 100%;float: left;;">
								<p style="padding-top: 12px;margin-bottom: 0;">2174</p>
								<p>积分</p>
							</div>
						</div>
						<div style="background: #f6f6f6;padding:0 10px;line-height: 28px;">
							<h4 style="padding-top: 20px;margin-top: 0;">{$Think.lang.basicInformation}</h4>
							<div style="width: 30%;float: left;">{$Think.lang.n_ame}</div>
							<div style="width: 70%;float: right;text-align: right;">{$vo.lastnamezh}{$vo.namezh}</div><br style="clear: both;">
							<div style="width: 30%;float: left;">{$Think.lang.Company}</div>
							<div style="width: 70%;float: right;text-align: right;">{$vo.comname}</div><br style="clear: both;">
							<div style="width: 30%;float: left;">{$Think.lang.Department}</div>
							<div style="width: 70%;float: right;text-align: right;">{$vo.department}</div><br style="clear: both;">
							<div style="width: 30%;float: left;">{$Think.lang.Position}</div>
							<div style="width: 70%;float: right;text-align: right;">{$vo.position}</div><br style="clear: both;">
							<foreach name="phone" item="pvo">
								<div style="width: 30%;float: left;">{$Think.lang.Phonenumber}</div>
								<div style="width: 70%;float: right;text-align: right;">{$pvo.phone}</div><br style="clear: both;">
							</foreach>
							<div style="float: left;width: 100%;">
								<div style="width: 30%;float: left;">{$Think.lang.Email}</div>
								<div style="width: 70%;float: right;text-align: right;height: auto;line-height: 1.5em;margin-top: 4px;word-wrap:break-word;">{$vo.email}</div><br style="clear: both;">
							</div>
							<div style="width: 30%;float: left;">{$Think.lang.IDcard}</div>
							<div style="width: 70%;float: right;text-align: right;">{$vo.identity}</div><br style="clear: both;">

							<div style="width: 30%;float: left;">{$Think.lang.Bankname}</div>
							<div style="width: 70%;float: right;text-align: right;">{$vo.bank}</div><br style="clear: both;">
							<div style="width: 30%;float: left;">{$Think.lang.BankAccount}</div>
							<div style="width: 70%;float: right;text-align: right;">{$vo.account}</div>
							<br style="clear: both;" />

							<h4 style="padding-top: 20px;margin-bottom: 0;">{$Think.lang.aboutme}</h4>
							<div>{$vo.remarks}</div>
							<div style="padding-top: 20px;text-align: center;padding-bottom: 15px;">
								<button class="btn btn-primary btn-sm" onclick="window.open('{:U(\'My/plAcc\')}')">{$Think.lang.myaccount}</button>
								<button class="btn btn-primary btn-sm" onclick="onm()">{$Think.lang.edit_information}</button>
								<button class="btn btn-danger btn-sm" onclick="window.open('{:U(\'System/proving\')}')">{$Think.lang.reset_Password}</button>
							</div>
						</div>
					</foreach>
				</div>
				<div style="width: 60%;float: right;">
					<div style="line-height: 30px;border-bottom:1px solid #e5e5e5;">{$Think.lang.focus_point}</div>
					<div style="height: 200px;">
						<div style="float: left;width: 25%;height: 100%;">
							<div class="six" style="width: 100px;height: 50px;background: #ececec;margin: 50px auto 0;position: relative;">
								<span style="display: block;width: 30px;height: 30px;margin:0 auto;padding-top: 10px;font-size: 30px;" class="glyphicon glyphicon-cog" aria-hidden="true"></span>
							</div>
							<!--<p style="text-align: center;padding-top:30px;">未解决事件</p>-->
						</div>
						<div style="float: left;width: 25%;height: 100%;">
							<div class="six" style="width: 100px;height: 50px;background: #ececec;margin: 50px auto 0;position: relative;">
								<span style="display: block;width: 30px;height: 30px;margin:0 auto;padding-top: 10px;font-size: 30px;" class="glyphicon glyphicon-dashboard" aria-hidden="true"></span>
							</div>
							<!--<p style="text-align: center;padding-top:30px;">考勤记录</p>-->
						</div>
						<div style="float: left;width: 25%;height: 100%;">
							<div class="six" style="width: 100px;height: 50px;background: #ececec;margin: 50px auto 0;position: relative;">
								<span style="display: block;width: 30px;height: 30px;margin:0 auto;padding-top: 10px;font-size: 30px;" class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
							</div>
							<!--<p style="text-align: center;padding-top:30px;">出错记录</p>-->
						</div>
						<div style="float: left;width: 25%;height: 100%;">
							<div class="six" style="width: 100px;height: 50px;background: #ececec;margin: 50px auto 0;position: relative;">
								<span style="display: block;width: 30px;height: 30px;margin:0 auto;padding-top: 10px;font-size: 30px;" class="glyphicon glyphicon-heart" aria-hidden="true"></span>
							</div>
							<!--<p style="text-align: center;padding-top:30px;">工资单</p>-->
						</div>
					</div>
					<ul id="myTab" class="nav nav-tabs">
						<li class="active">
							<a href="#home" data-toggle="tab">
								<!--系统通知(待处理)-->
								{$Think.lang.system_notification}
								<span class="badge" style="margin-left: 4px;float: right;"></span>
							</a>
						</li>
						<li>
							<a href="#ios" data-toggle="tab" onclick="aaa(2,'{$vo.role_id}')">
								{$Think.lang.system_authorization_status}
							</a>
						</li>
					</ul>
					<div id="myTabContent" class="tab-content">
						<div class="tab-pane fade in active" id="home" style="max-height: 400px;overflow-y: auto;">
							<table id="table1" style="width: 100%;border-collapse: collapse;" class="table table-hover table-bordered table-striped">
								<thead>
									<tr>
										<th>{$Think.lang.ID}</th>
										<th>{$Think.lang.notification_type}</th>
										<th>{$Think.lang.content}</th>
										<th>{$Think.lang.time}</th>
									</tr>
								</thead>
								<tbody>
									<volist name="meMessage" id="tongzhi">
										<tr>
											<td>{$i}</td>
											<td>{$tongzhi.type}</td>
											<td><a href="/index.php/Home/{$tongzhi.direction}">{$tongzhi.textzh}</a></td>
											<td>{$tongzhi.time}</td>
										</tr>
									</volist>
								</tbody>
							</table>
						</div>
						<div class="tab-pane fade" id="ios" style="height: 400px;overflow-y: scroll;">
							<table class="table table-hover mb-none">
								<thead>
									<tr>
										<th>{$Think.lang.privilege_name}</th>
										<th>{$Think.lang.permission}</th>
									</tr>
								</thead>
								<tbody>
									<foreach name="pinfo" item="showlist">
										<tr>
											<!-- 从零开始所以加一来做序列号-->
											<td>{$showlist.auth_name}</td>
											<td>　<input type="checkbox" style="width: 20px;height: 20px;" name="role_auth_ids[]" value="{$showlist.id}" disabled="disabled" /></td>
										</tr>
									</foreach>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</section>
	</div>
</div>
<div id="node_modal" class="modal fade  bs-example-modal-lg" tabindex="-1" role="dialog">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">
					{$Think.lang.edit_my_profile}
				</h4>
			</div>
			<form class="form-horizontal" action="{:U('My/saveuserinfo')}" method="POST">
				<div class="modal-body" style="line-height: 34px;">
					<foreach name="info" item="vo">
						<input type="hidden" name="id" value="{$vo.id}">
						<input type="hidden" name="uid" value="{$vo.uid}">
						<div class="row" style="margin-left: 0;margin-right: 0;">
							<div class="input-group">
								<span class="input-group-addon">Last Name in English</span>
								<input type="text" name="name" class="form-control" value="{$vo.lastname}" placeholder="Last Name" style="width: 30%;">
							</div>
							<div class="input-group">

								<span class="input-group-addon">First Name in English</span>
								<input type="text" name="lastname" class="form-control" value="{$vo.name}" placeholder="First Name" style="width: 30%;">
							</div>
							<div class="input-group" style="padding-top: 20px;">
								<span class="input-group-addon">{$Think.lang.Chinesesurname}</span>
								<input type="text" name="lastnamezh" class="form-control" value="{$vo.lastnamezh}" placeholder="" style="width: 20%;">
							</div>
							<div class="input-group">
								<span class="input-group-addon">{$Think.lang.Chinesename}</span>
								<input type="text" name="namezh" class="form-control" value="{$vo.namezh}" placeholder="" style="width: 20%;">
							</div>

							<div class="input-group" style="padding-top: 20px;padding-bottom: 20px;">
								<span class="input-group-addon">{$Think.lang.Email}</span>
								<input type="text" name="email" class="form-control" value="{$vo.email}" placeholder="" style="width: 50%;">
							</div>

							<div id="add_tel">
								<foreach name="phone" item="pvo">
									<div class="input-group">

										<span class="input-group-addon">{$Think.lang.Phonenumber}</span>
										<input type="text" name="contact[]" value="{$pvo.phone}" class="form-control" placeholder="" style="width: 30%;">

									</div>
								</foreach>
							</div>
							<div onclick="add_tel()" class="btn btn-primary" style="margin-top: 10px;">{$Think.lang.Addphone}</div>

							<div class="input-group" style="padding-top: 20px;">
								<span class="input-group-addon">{$Think.lang.bankname}</span>
								<input type="text" name="bank" value="{$vo.bank}" class="form-control" placeholder="" style="width: 50%;">
							</div>
							<div class="input-group">
								<span class="input-group-addon">{$Think.lang.Bankaccount}</span>
								<input type="text" name="account" value="{$vo.account}" class="form-control" placeholder="" style="width: 50%;">
							</div>
							<div class="input-group" style="padding-top: 20px;">
								<span class="input-group-addon">{$Think.lang.IDcard}</span>
								<input type="text" name="identity" value="{$vo.identity}" class="form-control" placeholder="" style="width: 40%;">
							</div>
							<div class="input-group" style="padding-top: 20px;">
								<span class="input-group-addon">{$Think.lang.Aboutme}</span>
								<textarea type="text" name="remarks" class="form-control" placeholder="" style="width: 40%;">{$vo.remarks}</textarea>
							</div>

							<!--性别-->
							<div class="input-group" style="padding-top: 20px;">
								<span class="input-group-addon">{$Think.lang.Sex}</span>
								<div style="border: 1px solid #ccc;width: 30%;border-bottom-right-radius: 4px;border-top-right-radius: 4px;">
									<eq name="vo.sex" value="1">
										<label for="man2">
											<input id="man2" type="radio" name="sex" value="1" checked="checked" style="margin-left: 20px;vertical-align: top;margin-top: 10px;">{$Think.lang.Man}
										</label>
										<label for="woman2" style="margin-left: 12px;">
											<input id="woman2" type="radio" name="sex" style="vertical-align: top;margin-top: 10px;">{$Think.lang.Woman}
										</label>
									</eq>
									<eq name="vo.sex" value="2">
										<label for="man1">
											<input id="man1" type="radio" name="sex" value="1"  style="margin-left: 20px;vertical-align: top;margin-top: 10px;">{$Think.lang.Man}
										</label>
										<label for="woman1">
											<input id="woman1" type="radio" name="sex" checked="checked" value="2" style="vertical-align: top;margin-top: 10px;">{$Think.lang.Woman}
										</label>
									</eq>
								</div>
							</div>
						</div>

					</foreach>
				</div>
				<div class="modal-footer">
					<button class="btn btn-primary" type="submit">{$Think.lang.Save}</button>
					<button type="button" class="btn btn-default" data-dismiss="modal">{$Think.lang.Cancel}</button>
				</div>
			</form>
		</div>
		<!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>
<script src="__ROOT__/Public/FirstEdition/assets/shu/boot/table.js"></script>
<script>
	$(document).ready(function() {
		$('#table1').DataTable({
			"paging": false,
			"lengthChange": false,
			"info": false,
			"searching": false
		});
	});

	function onm() {
		$('#node_modal').modal('toggle');
	}

	function aaa(type, roleId) {
		var getRoleAuthorityUrl = $("[name='getRoleAuthority']").val();
		$.ajax({
			url: getRoleAuthorityUrl, //通过JQ获取URL获得路径
			data: {
				type: type,
				role_id: roleId
			}, //通过页面元素的ID来获取设备ID
			type: "post", //选择传值方式
			dataType: "JSON",
			success: function(data) {
				console.log(data);
				if (data.info){
					$('#node_message').html('{$Think.lang.Operationauthority}');
					node_message.style.display = 'block';
					var t = setTimeout("node_message.style.display='none';", 2000);
				}else if(data) {
					//点开或者关闭模态
					var list = data.nodeList;
					console.log(data);
					var boxes = document.getElementsByName("role_auth_ids[]");
					$("input[type='checkbox']").attr("checked", false);
					for(i = 0; i < boxes.length; i++) {
						for(j = 0; j < list.length; j++) {
							if(boxes[i].value == list[j]) {
								boxes[i].checked = true;
								console.log(boxes[i].value);
								break
							}
						}
					}
				}
			}
		})
	}

	function add_tel() {
		var list = '<div class="input-group"><span class="input-group-addon">{$Think.lang.Phonenumber}</span><input type="text" name="contact[]" class="form-control" placeholder="" style="width: 30%;"></div>'
		$('#add_tel').append(list)
	};
</script>