<script src="__ROOT__/Public/login/assets/js/jquery-1.11.1.min.js">

</script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />
<script>
	$('#11').parents('li').addClass('nav-active')
	$('#11').parents('li').addClass('nav-expanded')
</script>
<style>
	.six:before{
		content:"";
		position: absolute;
		top: -1.5rem;
		left: 0;
		width:0;
		height: 0;
		border-left: 3rem solid transparent;
		border-right: 3rem solid transparent;
		border-bottom: 1.5rem solid #ececec;
	}
	.six:after{
		content:"";
		position: absolute;
		bottom: -1.5rem;
		left: 0;
		width:0;
		height: 0;
		border-left: 3rem solid transparent;
		border-right: 3rem solid transparent;
		border-top: 1.5rem solid #ececec;
	}
	.dropdown-toggle{
		height: 34px;
	}
	label{
		margin-bottom: 0;
	}
</style>
<div class="row">
	<div class="col-md-12">
		<section class="panel">
			<header class="panel-heading">
				<div class="panel-actions">
					<a href="#" class="panel-action panel-action-toggle" data-panel-toggle=""></a>
					<a href="#" class="panel-action panel-action-dismiss" data-panel-dismiss=""></a>
				</div>
				<input type="hidden" name='getRoleAuthority' value="{:U('System/getRoleAuthority','','')}">
				<h2 class="panel-title">个人信息</h2>
			</header>
			<!--<div class="panel-body">
                <button class="btn btn-primary" onclick=""> </button>
            </div>-->
			<input type="hidden" name='getRoleAuthority' value="{:U('System/getRoleAuthority','','')}">
			<input type="hidden" name='delRole' value="{:U('System/delRole','','')}">
			<div class="panel-body">
				<div style="width: 100%;float: left;">
					<div style="width: 100%;height: 120px;background: url('__ROOT__/Public/img/bg.jpg');background-size: cover;">
						<div style="width: 80px;margin: 0 auto;">
							<foreach name="info" item="vo" >
								<img style="width: 80px;display: block;height: 80px;margin: 0 auto;padding-top: 20px;cursor: pointer;box-sizing: content-box;" src="__ROOT__{$vo.path}" onclick="location.href='__ROOT__/index.php/Home/my/avatar'"/>
							</foreach>
						</div>

					</div>
					<foreach name="info" item="vo" >
					<div style="height: 70px;background: deepskyblue;color: #fff;text-align: center;line-height: 24px;">
						<div style="width: 33%;border-right: 1px solid #fff;height: 100%;float: left;">
							<p style="padding-top: 12px;margin-bottom: 0;">白金</p>
							<p>雇员</p>
						</div>
						<div style="width: 34%;border-right: 1px solid #fff;height: 100%;float: left;;">
							<p style="padding-top: 12px;margin-bottom: 0;">Active</p>
							<eq name="vo.status" value="1">
								正常
								<else/>
								离职
							</eq>
						</div>
						<div style="width: 33%;height: 100%;float: left;;">
							<p style="padding-top: 12px;margin-bottom: 0;">2174</p>
							<p>积分</p>
						</div>
					</div>
					<div style="background: #f6f6f6;padding:0 20px;line-height: 28px;">
						<h4 style="padding-top: 20px;margin-top: 0;">基本信息</h4>
						<div style="width: 30%;float: left;">姓名</div>
						<div style="width: 70%;float: right;text-align: right;">{$vo.lastnamezh}{$vo.namezh}</div><br>
						<div style="width: 30%;float: left;">公司</div>
						<div style="width: 70%;float: right;text-align: right;">{$vo.comname}</div><br>
						<div style="width: 30%;float: left;">部门</div>
						<div style="width: 70%;float: right;text-align: right;">{$vo.department}</div><br>
						<div style="width: 30%;float: left;">职位</div>
						<div style="width: 70%;float: right;text-align: right;">{$vo.position}</div><br>
						<foreach name="phone" item="pvo" >
						<div style="width: 30%;float: left;">电话</div>
						<div style="width: 70%;float: right;text-align: right;">{$pvo.phone}</div><br>
							</foreach>
						<div style="width: 30%;float: left;">电子邮件</div>
						<div style="width: 70%;float: right;text-align: right;">{$vo.email}</div><br>
						<div style="width: 30%;float: left;">身份证号码</div>
						<div style="width: 70%;float: right;text-align: right;">{$vo.identity}</div><br>
						<div style="width: 30%;float: left;">开户银行</div>
						<div style="width: 70%;float: right;text-align: right;">{$vo.bank}</div><br>
						<div style="width: 30%;float: left;">银行账号</div>
						<div style="width: 70%;float: right;text-align: right;">{$vo.account}</div><br>
						<br style="clear: both;" />


						<h4 style="padding-top: 20px;margin-bottom: 0;">关于我</h4>
						<div>{$vo.remarks}</div>
						<div style="padding-top: 20px;text-align: center;padding-bottom: 15px;" >
							<button class="btn btn-primary" onclick="location.href='{:U(\'My/plAcc\')}'">我的账号</button>
							<button class="btn btn-primary" onclick="onm()">编辑资料</button>
							<button class="btn btn-danger" onclick="location.href='{:U(\'System/edit\')}'">重置密码</button>
						</div>
					</div>
					</foreach>
				</div>
				<div style="width: 100%;float: right;">
					<div style="line-height: 30px;border-bottom:1px solid #e5e5e5;">关注点</div>
					<div style="height: 12rem;">
						<div style="float: left;width: 25%;height: 100%;">
							<div class="six"  style="width: 6rem;height: 3rem;background: #ececec;margin: 3rem auto 0;position: relative;">
								<span style="display: block;width: 2rem;height: 2rem;margin:0 auto;padding-top: .5rem;font-size: 2rem;text-align: center;" class="glyphicon glyphicon-cog" aria-hidden="true"></span>
							</div>
							<p style="text-align: center;padding-top:1.8rem;">未解决事件</p>
						</div>
						<div style="float: left;width: 25%;height: 100%;">
							<div class="six" style="width: 6rem;height: 3rem;background: #ececec;margin: 3rem auto 0;position: relative;">
								<span style="display: block;width: 2rem;height: 2rem;margin:0 auto;padding-top: .5rem;font-size: 2rem;text-align: center;" class="glyphicon glyphicon-dashboard" aria-hidden="true"></span>
							</div>
							<p style="text-align: center;padding-top:1.8rem;">考勤记录</p>
						</div>
						<div style="float: left;width: 25%;height: 100%;">
							<div class="six" style="width: 6rem;height: 3rem;background: #ececec;margin: 3rem auto 0;position: relative;">
								<span style="display: block;width: 2rem;height: 2rem;margin:0 auto;padding-top: .5rem;font-size: 2rem;text-align: center;" class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
							</div>
							<p style="text-align: center;padding-top:1.8rem;">出错记录</p>
						</div>
						<div style="float: left;width: 25%;height: 100%;">
							<div class="six" style="width: 6rem;height: 3rem;background: #ececec;margin: 3rem auto 0;position: relative;">
								<span style="display: block;width: 2rem;height: 2rem;margin:0 auto;padding-top: .5rem;font-size: 2rem;text-align: center;;" class="glyphicon glyphicon-heart" aria-hidden="true"></span>
							</div>
							<p style="text-align: center;padding-top:1.8rem;">工资单</p>
						</div>
					</div>
					<ul id="myTab" class="nav nav-tabs">
						<li class="active">
							<a href="#home" data-toggle="tab">
								站内信(待回复)
								<span class="badge" style="margin-left: 4px;float: right;">4</span>
							</a>
						</li>
						<li>
							<a href="#ios" data-toggle="tab" onclick="aaa(2,'{$vo.role_id}')">
								系统授权状态
							</a>
						</li>
					</ul>
					<div id="myTabContent" class="tab-content">
						<div class="tab-pane fade in active" id="home">
							<div style="height: 80px;">
							<p style="margin-bottom: 0;">Commented on post <span style="color: deepskyblue">Prototyping</span></p>
							<p style="font-size: 12px;color: #999;">2 minutes ago</p>
							</div>
							<div style="height: 80px;">
							<p style="margin-bottom: 0;">Commented on post <span style="color: deepskyblue">Prototyping</span></p>
							<p style="font-size: 12px;color: #999;">2 minutes ago</p>
							</div>
							<div style="height: 80px;">
							<p style="margin-bottom: 0;">Commented on post <span style="color: deepskyblue">Prototyping</span></p>
							<p style="font-size: 12px;color: #999;">2 minutes ago</p>
							</div>
						</div>
						<div class="tab-pane fade" id="ios" style="height: 400px;overflow-y: scroll;">
							<table class="table table-hover mb-none">
								<thead>
								<tr>
									<th>权限名称</th>
									<th>已有权限</th>
								</tr>
								</thead>
								<tbody>
								<foreach name="pinfo" item="showlist">
									<tr>
										<!-- 从零开始所以加一来做序列号-->
										<td>{$showlist.auth_name}</td>
										<td>　<input type="checkbox"  style="width: 20px;height: 20px;" name="role_auth_ids[]"  value="{$showlist.id}"disabled="disabled" /></td>

									</tr>
								</foreach>
								</foreach>
								</tbody>

							</table>
						</div>
					</div>

				</div>
			</div>
		</section>
	</div>
</div>
<div id="node_modal" class="modal fade  bs-example-modal-lg" tabindex="-1" role="dialog">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">
					编辑我的个人资料
				</h4>
			</div>
			<form  class="form-horizontal" action="{:U('My/saveuserinfo')}" method="POST">
			<div class="modal-body" style="line-height: 34px;">
				<foreach name="info" item="vo" >
					<input type="hidden"  name="id" value="{$vo.id}">

					<div class="row" style="margin-left: 0;margin-right: 0;">
						<div class="input-group">

							<span class="input-group-addon">First Name in English</span>
							<input type="text" name="lastname" class="form-control"value="{$vo.lastname}" placeholder="First Name">
						</div>
						<div class="input-group">
							<span class="input-group-addon">Last Name in English</span>
							<input type="text" name="name" class="form-control" value="{$vo.name}"placeholder="Last Name">
						</div>
						<div class="input-group" style="padding-top:1.2rem;">
							<span class="input-group-addon">中文名</span>
							<input type="text" name="namezh" class="form-control" value="{$vo.namezh}" placeholder="">
						</div>
						<div class="input-group">
							<span class="input-group-addon">中文姓</span>
							<input type="text" name="lastnamezh" class="form-control"value="{$vo.lastnamezh}" placeholder="">
						</div>

						<div class="input-group" style="padding-top:1.2rem;">
							<span class="input-group-addon">电子邮件</span>
							<input type="text" name="email" class="form-control"value="{$vo.email}" placeholder="">
						</div>

						<div id="add_tel">
							<foreach name="phone" item="pvo" >
							<div class="input-group" style="padding-top:1.2rem;">

								<span class="input-group-addon">电话号码</span>
								<input type="text" name="contact[]" value="{$pvo.phone}"class="form-control" placeholder="">

							</div>
							</foreach>
						</div>
						<div onclick="add_tel()" class="btn btn-primary" style="margin-top: 10px;">增加电话</div>

						<div class="input-group" style="padding-top:1.2rem;">
							<span class="input-group-addon">开户行（请包含分行名称）</span>
							<input type="text" name="bank" value="{$vo.bank}"class="form-control" placeholder="">
						</div>
						<div class="input-group">
							<span class="input-group-addon">银行账号</span>
							<input type="text" name="account"value="{$vo.account}" class="form-control" placeholder="">
						</div>
						<div class="input-group" style="padding-top:1.2rem;">
							<span class="input-group-addon">身份证号</span>
							<input type="text" name="identity" value="{$vo.identity}"class="form-control" placeholder="">
						</div>
						<div class="input-group" style="padding-top:1.2rem;">
							<span class="input-group-addon">关于我  < 150字</span>
							<textarea type="text" name="remarks" class="form-control" placeholder="">{$vo.remarks}</textarea>
						</div>

						<!--性别-->
						<div class="input-group" style="padding-top:1.2rem;">
							<span class="input-group-addon">性别</span>
							<div style="border: 1px solid #ccc;width: 100%;border-bottom-right-radius: 4px;border-top-right-radius: 4px;">

								<eq name="vo.sex" value="1">
									<label for="man2">
										<input id="man2" type="radio" name="sex" value="1" checked="checked" style="margin-left: 20px;vertical-align: top;margin-top: 10px;">男
									</label>
									<label for="woman2" style="margin-left: 12px;">
										<input id="woman2" type="radio" name="sex" style="vertical-align: top;margin-top: 10px;">女
									</label>
								</eq>
								<eq name="vo.sex" value="2">
									<label for="man1">
										<input id="man1" type="radio" name="sex" value="1"  style="margin-left: 20px;vertical-align: top;margin-top: 10px;">男
									</label>
									<label for="woman1">
										<input id="woman1" type="radio" name="sex" checked="checked" value="2" style="vertical-align: top;margin-top: 10px;">女
									</label>
								</eq>
							</div>
						</div>
					</div>

					</foreach>
			</div>
			<div class="modal-footer">
				<button class="btn btn-primary" type="submit">保存</button>
				<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
			</div>
			</form>
		</div>
		<!-- /.modal-content -->
	</div>
	<!-- /.modal-dialog -->
</div>
<script>
	
	function onm() {
		$('#node_modal').modal('toggle');
	}
	function aaa(type,roleId) {
		var getRoleAuthorityUrl = $("[name='getRoleAuthority']").val();
			$.ajax({
				url: getRoleAuthorityUrl,            //通过JQ获取URL获得路径
				data: {type:type,role_id:roleId},       //通过页面元素的ID来获取设备ID
				type: "post",        //选择传值方式
				dataType: "JSON",
				success: function (data) {
					if (data) {
						//点开或者关闭模态
						console.log(data);
						var list=data.nodeList;
						console.log(data);
						var boxes = document.getElementsByName("role_auth_ids[]");
						$("input[type='checkbox']").attr("checked",false);
						for(i=0;i<boxes.length;i++){
							for(j=0;j<list.length;j++){
								if(boxes[i].value==list[j]){
									boxes[i].checked=true;
									console.log(boxes[i].value);
									break
								}
							}
						}
					}
				}
			})
	}
	function add_tel(){
		var list ='<div class="input-group"><span class="input-group-addon">电话号码</span><input type="text" name="contact[]" class="form-control" placeholder="" style="width: 30%;"></div>'
		$('#add_tel').append(list)
	};
</script>

